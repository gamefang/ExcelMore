# Excel聚光灯设置方式

> 原理：通过条件格式，借用CELL函数的特殊性，追踪选中单元格的位置并改变相关行、列颜色，并通过VBA实现切换单元格时刷新

## 底层支持
- 将Excel存为xlsm格式
	- 为避免保存时的神烦弹窗，调整：文件->选项->信任中心->信任中心设置->隐私选项->保存时从文件属性中删除个人信息（不勾选）

- 进入Visual Basic，点击展开需要使用聚光灯的Sheet对象，加入代码

```vb
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Calculate
End Sub
```

## 规则设置
- 返回Excel需要设置聚光灯的Sheet，选中相应区域，新建条件格式的规则
	- 选择规则类型：使用公式确定要设置格式的单元格
	- 为符合此公式的值设置格式：根据希望的聚光灯效果，选填下述公式的一种
		- 所在行列均高亮：`=OR(CELL("row")=ROW(),CELL("col")=COLUMN())`
		- 仅高亮选中单元格：`=AND(CELL("row")=ROW(),CELL("col")=COLUMN())`
		- 仅高亮选中单元格所在行：`=CELL("row")=ROW()`
		- 仅高亮选中单元格所在列：`=CELL("col")=COLUMN()`
	- 格式：自主选择填充颜色
- 使用管理规则，可进一步调整聚光灯区域
	- 在应用于的公式处，可修改聚光灯适用的区域
	- 如区域为不连续的，使用英文逗号将其分开。例如：`=$A$1:$B$2,$D$1:$E$2`
- 因聚光灯实质为条件格式，可设置叠加多个聚光灯，其优先级在规则中按降序排列
- 应用于合并单元格效果不佳，选中单元格只会被认定为左上角单元格