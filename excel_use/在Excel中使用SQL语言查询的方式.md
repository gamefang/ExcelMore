# 在Excel中使用SQL语言查询的方式

## 连接Excel表作为数据库的方式
- 新建Excel表，选择：数据->新建查询->从文件->从工作簿->选择可作为数据库的Excel文件
- 选择作为数据库表的Sheet，点击加载。
	- 如Sheet结构严格符合表头+数据行的形式，无需修改
	- 如表头不在第一行，点击编辑，转入Power Query编辑器
		- 先删除表头上方行，选择：删除行->删除最前面几行->插入->输入需要删除的行数(不包括表头行)
		- 设置表头：点击将第一行用作标题，选择插入
		- 点击关闭，保留更改
- 此时返回Excel，会新建一个Sheet，引用全部数据，形成一张表
- 点击：数据->属性->连接属性(名称最右的图标)->定义
- 在此时连接属性的页面中，命令类型为SQL，命令文本为此时查询用的SQL语句，可随时更改，修改后Excel表格会动态刷新
- 调整使用状况页签中的刷新控件，可调整刷新方式。一般为打开文件时刷新数据。

## 注意事项
- 由于查询与文件强关联，如Excel文件路径或名称修改，则查询连接会失效，需重新建立
- 不支持--注释，但可用/* */注释
- 连接Excel表的方法对CSV等文件类型可同理操作

## 示例

```sql
-- 去除某列的空行查询
SELECT * FROM [表名]
WHERE [列名] IS NOT NULL

-- 只查询某列为某几个值的行
SELECT * FROM [表名]
WHERE [列名] IN ("文本值1","文本值2")

-- 时间相关比较运算，须使用YEAR、MONTH、DAY转化
SELECT * FROM [表名]
WHERE YEAR([时间列]) > 2022 AND MONTH([时间列]) > 7

-- Boolean相关比较运算，直接使用0(FALSE)和1(TRUE)
SELECT * FROM [表名]
WHERE [布尔列] = 1

-- LIKE运算符不支持，待研究，有以下替代品
-- 筛选由XXX开头或结尾的，LEFT、RIGHT使用同Excel公式
SELECT * FROM [表名]
WHERE LEFT([布尔列],2) = "XX"
```